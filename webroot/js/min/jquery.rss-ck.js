!function($){"use strict";var e=function(e,t,n,i){this.target=e,this.url=t,this.html=[],this.effectQueue=[],this.options=$.extend({ssl:!1,limit:null,key:null,layoutTemplate:"<ul>{entries}</ul>",entryTemplate:'<li><a href="{url}">[{author}@{date}] {title}</a><br/>{shortBodyPlain}</li>',tokens:{},outputMode:"json",effect:"show",error:function(){console.log("jQuery RSS: url doesn't link to RSS-Feed")},success:function(){}},n||{}),this.callback=i||this.options.success};e.htmlTags=["doctype","html","head","title","base","link","meta","style","script","noscript","body","article","nav","aside","section","header","footer","h1-h6","hgroup","address","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","figure","figcaption","div","table","caption","thead","tbody","tfoot","tr","th","td","col","colgroup","form","fieldset","legend","label","input","button","select","datalist","optgroup","option","textarea","keygen","output","progress","meter","details","summary","command","menu","del","ins","img","iframe","embed","object","param","video","audio","source","canvas","track","map","area","a","em","strong","i","b","u","s","small","abbr","q","cite","dfn","sub","sup","time","code","kbd","samp","var","mark","bdi","bdo","ruby","rt","rp","span","br","wbr"],e.prototype.load=function(e){var t="https"+(this.options.ssl?"s":""),n=t+"://ajax.googleapis.com/ajax/services/feed/load",i=n+"?v=1.0&output="+this.options.outputMode+"&callback=?&q="+encodeURIComponent(this.url);null!=this.options.limit&&(i+="&num="+this.options.limit),null!=this.options.key&&(i+="&key="+this.options.key),$.getJSON(i,e)},e.prototype.render=function(){var e=this;this.load(function(t){try{e.feed=t.responseData.feed,e.entries=t.responseData.feed.entries}catch(n){return e.entries=[],e.feed=null,e.options.error.call(e)}var i=e.generateHTMLForEntries();e.target.append(i.layout),0!==i.entries.length&&e.appendEntriesAndApplyEffects($("entries",i.layout),i.entries),e.effectQueue.length>0?e.executeEffectQueue(e.callback):$.isFunction(e.callback)&&e.callback.call(e)})},e.prototype.appendEntriesAndApplyEffects=function(e,t){var n=this;$.each(t,function(t,i){var o=n.wrapContent(i);"show"===n.options.effect?e.before(o):(o.css({display:"none"}),e.before(o),n.applyEffect(o,n.options.effect))}),e.remove()},e.prototype.generateHTMLForEntries=function(){var e=this,t={entries:[],layout:null};return $(this.entries).each(function(){var n=this;if(e.isRelevant(n)){var i=e.evaluateStringForEntry(e.options.entryTemplate,n);t.entries.push(i)}}),t.layout=this.wrapContent(this.options.entryTemplate?this.options.layoutTemplate.replace("{entries}","<entries></entries>"):"<div><entries></entries></div>"),t},e.prototype.wrapContent=function(e){return $(0!==$.trim(e).indexOf("<")?"<div>"+e+"</div>":e)},e.prototype.applyEffect=function(e,t,n){var i=this;switch(t){case"slide":e.slideDown("slow",n);break;case"slideFast":e.slideDown(n);break;case"slideSynced":i.effectQueue.push({element:e,effect:"slide"});break;case"slideFastSynced":i.effectQueue.push({element:e,effect:"slideFast"})}},e.prototype.executeEffectQueue=function(e){var t=this;this.effectQueue.reverse();var n=function(){var i=t.effectQueue.pop();i?t.applyEffect(i.element,i.effect,n):e&&e()};n()},e.prototype.evaluateStringForEntry=function(e,t){var n=e,i=this;return $(e.match(/(\{.*?\})/g)).each(function(){var e=this.toString();n=n.replace(e,i.getValueForToken(e,t))}),n},e.prototype.isRelevant=function(e){var t=this.getTokenMap(e);return this.options.filter?this.options.filterLimit&&this.options.filterLimit==this.html.length?!1:this.options.filter(e,t):!0},e.prototype.getTokenMap=function(t){if(!this.feedTokens){var n=JSON.parse(JSON.stringify(this.feed));delete n.entries,this.feedTokens=n}return $.extend({feed:this.feedTokens,url:t.link,author:t.author,date:t.publishedDate,title:t.title,body:t.content,shortBody:t.contentSnippet,bodyPlain:function(t){for(var n=t.content.replace(/<script[\\r\\\s\S]*<\/script>/gim,"").replace(/<\/?[^>]+>/gi,""),i=0;i<e.htmlTags.length;i++)n=n.replace(new RegExp("<"+e.htmlTags[i],"gi"),"");return n}(t),shortBodyPlain:t.contentSnippet.replace(/<\/?[^>]+>/gi,""),index:$.inArray(t,this.entries),totalEntries:this.entries.length,teaserImage:function(e){try{return e.content.match(/(<img.*?>)/gi)[0]}catch(t){return""}}(t),teaserImageUrl:function(e){try{return e.content.match(/(<img.*?>)/gi)[0].match(/src="(.*?)"/)[1]}catch(t){return""}}(t)},this.options.tokens)},e.prototype.getValueForToken=function(e,t){var n=this.getTokenMap(t),i=e.replace(/[\{\}]/g,""),o=n[i];if("undefined"!=typeof o)return"function"==typeof o?o(t,n):o;throw new Error("Unknown token: "+e)},$.fn.rss=function(t,n,i){return new e(this,t,n,i).render(),this}}(jQuery);